<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Qtum-cli (Desktop) - Bodhi Prediction Market Wiki</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="../../css/custom.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Qtum-cli (Desktop)";
    var mkdocs_page_input_path = "bodhi_token/qtum_cli.md";
    var mkdocs_page_url = "/bodhi_token/qtum_cli/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Bodhi Prediction Market Wiki</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Bodhi Token</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../info/">Info</a>
                </li>
                <li class="">
                    
    <a class="" href="../qbao/">QBao (Mobile)</a>
                </li>
                <li class="">
                    
    <a class="" href="../qtum_wallet_mobile/">Qtum Wallet (Mobile)</a>
                </li>
                <li class="">
                    
    <a class="" href="../qt_wallet_desktop/">QT Wallet (Desktop)</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Qtum-cli (Desktop)</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#downloads">Downloads</a></li>
    

    <li class="toctree-l3"><a href="#launch-qtum-daemon">Launch Qtum daemon</a></li>
    

    <li class="toctree-l3"><a href="#encode-address-to-hex">Encode address to hex</a></li>
    

    <li class="toctree-l3"><a href="#send-bot">Send BOT</a></li>
    

    <li class="toctree-l3"><a href="#receive-bot">Receive BOT</a></li>
    

    <li class="toctree-l3"><a href="#check-bot-balance">Check BOT balance</a></li>
    

    <li class="toctree-l3"><a href="#parse-events-with-ethabi">Parse Events with ethabi</a></li>
    

    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Bodhi Core</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../bodhi_core/info/">Info</a>
                </li>
                <li class="">
                    
    <a class="" href="../../bodhi_core/topic_event/">TopicEvent</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Qtum</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../qtum/qt_wallet/">QT Wallet (Desktop)</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../deployment/">Contract Deployment</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../help/">Help</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Bodhi Prediction Market Wiki</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Bodhi Token &raquo;</li>
        
      
    
    <li>Qtum-cli (Desktop)</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="downloads">Downloads</h1>
<ul>
<li>QT wallet/qtum-cli - find latest release and download installer:<ul>
<li><a href="https://github.com/qtumproject/qtum/releases">https://github.com/qtumproject/qtum/releases</a></li>
</ul>
</li>
<li>Ethabi<ul>
<li><a href="https://github.com/paritytech/ethabi">https://github.com/paritytech/ethabi</a> </li>
</ul>
</li>
</ul>
<h1 id="launch-qtum-daemon">Launch Qtum daemon</h1>
<p>In your Terminal window, go to your <code>qtum-x.xx.x/bin</code> folder that you installed it in and run:</p>
<pre><code>$ ./qtumd --logevents
</code></pre>
<p>To reindex the chain:</p>
<pre><code>$ ./qtumd --logevents --reindex
</code></pre>
<h1 id="encode-address-to-hex">Encode address to hex</h1>
<pre><code>$ ./qtum-cli gethexaddress QgRUhP8sLMCNKrzwtW4xU5DF8CCTeiA3sF
# hash address:
d965cdc9eff7412a278cd9dd7dc32e022b7bada4

$ ethabi encode params -v address d965cdc9eff7412a278cd9dd7dc32e022b7bada4
# encoded address with ethabi (padded to 32 bytes):
000000000000000000000000d965cdc9eff7412a278cd9dd7dc32e022b7bada4
</code></pre>
<h1 id="send-bot">Send BOT</h1>
<ol>
<li><a href="#launch-qtum-daemon">Launch Qtum daemon</a></li>
<li>Open a new Terminal tab</li>
<li>
<p>Transfer BOT using <code>transfer(address, uint256)</code>:</p>
<pre><code># sendtocontract help
Arguments:
1. "contractAddress" (string, required) The contract address that will receive the funds and data.
2. "dataHex"  (string, required) data to send.
3. "amount"      (numeric or string, optional) The amount in QTUM to send. eg 0.1, default: 0
4. gasLimit  (numeric or string, optional) gasLimit, default: 250000, max: 40000000
5. gasPrice  (numeric or string, optional) gasPrice Qtum price per gas unit, default: 0.0000004, min:0.0000004
6. "senderAddress" (string, optional) The quantum address that will be used as sender.

$ ./qtum-cli sendtocontract contractAddress dataHex amount gasLimit gasPrice senderAddress
</code></pre>
<p>Constructing the <code>dataHex</code> for <code>transfer(address, uint256)</code>:</p>
<p>This data string is a hex string of data which consists of the function name and it's parameters. All parts of hex strings need to be concatenated together with no space in between. Each parameter should be encoded to 32 bytes.</p>
<ul>
<li>Function name: <code>transfer(address,uint256)</code> = <a href="../info/#function-signatures">function signature</a>: <code>a9059cbb</code></li>
<li>First param: <code>address</code> = recipient <a href="#encode-address-to-hex">encoded address</a> to send BOT to: <code>000000000000000000000000d965cdc9eff7412a278cd9dd7dc32e022b7bada4</code></li>
<li>Second parameter: <code>uint256</code> = amount to send to in lowest denomination of BOT (Botoshi). <pre><code>$ ethabi encode params -v uint 10000 --lenient
0000000000000000000000000000000000000000000000000000000000002710
</code></pre>
</li>
</ul>
<p>Now we have all the params we need encoded properly:</p>
<pre><code>a9059cbb # function param
000000000000000000000000d965cdc9eff7412a278cd9dd7dc32e022b7bada4 # address param
0000000000000000000000000000000000000000000000000000000000002710 # uint256 param

# dataHex concatenated without any spaces:
a9059cbb000000000000000000000000d965cdc9eff7412a278cd9dd7dc32e022b7bada40000000000000000000000000000000000000000000000000000000000002710
</code></pre>
<p>Finally the last arguments needed in the call:</p>
<pre><code># other parameters needed:
# amount = 0 (no QTUM to send)
# gasLimit = 250000 (default)
# gasPrice = 0.0000004 (default)
# senderAddress = QgRUhP8sLMCNKrzwtW4xU5DF8CCTeiA3sF (address that is transferring BOT)
</code></pre>
<p>Execute the transfer():</p>
<pre><code>$ ./qtum-cli sendtocontract f13f51550faaf698d09fdcc74d79335bfe19e062 a9059cbb000000000000000000000000d965cdc9eff7412a278cd9dd7dc32e022b7bada40000000000000000000000000000000000000000000000000000000000002710 0 250000 0.0000004 QgRUhP8sLMCNKrzwtW4xU5DF8CCTeiA3sF
# transaction receipt
{
  "txid": "25af2f8cc32e76b52b39175336612f0ae568906216667e6482421edce2909f72",
  "sender": "QgRUhP8sLMCNKrzwtW4xU5DF8CCTeiA3sF",
  "hash160": "d965cdc9eff7412a278cd9dd7dc32e022b7bada4"
}
</code></pre>
</li>
<li>
<p>Check for transaction to be mined:</p>
<pre><code># $ ./qtum-cli gettransaction txid
$ ./qtum-cli gettransaction 25af2f8cc32e76b52b39175336612f0ae568906216667e6482421edce2909f72

# look at "confirmations" to be 1 or more
{
    "amount": 0.00000000,
    "fee": -0.10120000,
    "confirmations": 0, # once this hits 1 confirmation, you can check the balance
    "blockhash": "c7eb9ff50dafc4c8c0b0e519eeea8dc98be5209d82e2a49c88be6173796bef75",
    "blockindex": 2,
    "blocktime": 1511152112,
    "txid": "25af2f8cc32e76b52b39175336612f0ae568906216667e6482421edce2909f72",
    "walletconflicts": [
    ],
    "time": 1511152081,
    "timereceived": 1511152081,
    "bip125-replaceable": "no",
    "details": [
    {
      "account": "",
      "category": "send",
      "amount": 0.00000000,
      "vout": 0,
      "fee": -0.10120000,
      "abandoned": false
    }, 
    {
      "account": "",
      "address": "qKjn4fStBaAtwGiwueJf9qFxgpbAvf1xAy",
      "category": "send",
      "amount": -91.78832400,
      "label": "main",
      "vout": 1,
      "fee": -0.10120000,
      "abandoned": false
    }, 
    {
      "account": "main",
      "address": "qKjn4fStBaAtwGiwueJf9qFxgpbAvf1xAy",
      "category": "receive",
      "amount": 91.78832400,
      "label": "main",
      "vout": 1
    }
    ],
    "hex": "020000000106752a723b35434e877b7b4bf30635df1a46690563711324721dec800e38d79d000000006b483045022100de725038c8d2e1474b88f0c04121f18ad644596b527f65ff43732e5ee47394360220240812330bcf00a41e79e63f3e2d660d76e4dc13286653015385e5dff2638b8e0121038e8b6337a06712e40277d339b4643897e62b337b66eea2d8dd069812d7feb0a3feffffff0200000000000000006301040390d003012844a9059cbb00000000000000000000000074fafd43036239029a5dabc9463009daf4ef4a7c0000000000000000000000000000000000000000000000000000000005f5e10014f6177bc9812eeb531907621af6641a41133dea9ec210de1923020000001976a91417e7888aa7412a735f336d2f6d784caefabb6fa388ac8b8a0000"
}
</code></pre>
</li>
</ol>
<h1 id="receive-bot">Receive BOT</h1>
<ol>
<li><a href="#launch-qtum-daemon">Launch Qtum daemon</a></li>
<li>Open a new Terminal tab</li>
<li>
<p>List your accounts:</p>
<pre><code>$ ./qtum-cli listaddressgroupings
[
  [
    [
      "qKjn4fStBaAtwGiwueJf9qFxgpbAvf1xAy", 
      91.78832400, 
      "main"
    ]
  ]
]
</code></pre>
</li>
<li>
<p>Pick an address to receive and give that to the person sending you the BOT</p>
</li>
</ol>
<h1 id="check-bot-balance">Check BOT balance</h1>
<ol>
<li><a href="#launch-qtum-daemon">Launch Qtum daemon</a></li>
<li>
<p>Use <code>callcontract</code> to check the balance:</p>
<ul>
<li>Function name: <code>balanceOf(address)</code> = <a href="../info/#function-signatures">function signature</a>: <code>70a08231</code></li>
<li>First param: <code>address</code> = <a href="#encode-address-to-hex">encoded address</a> to check balanceOf<pre><code># $ ./qtum-cli callcontract contractAddress dataHex
# dataHex:
# function signature: 70a08231 
# address: 0000000000000000000000004cb69aae6761e52413b948ad10689cc2428e2ef7
$ ./qtum-cli callcontract f13f51550faaf698d09fdcc74d79335bfe19e062 70a082310000000000000000000000004cb69aae6761e52413b948ad10689cc2428e2ef7
{
  "address": "a619b1a87d4f17fb56e347887b971094918b016c",
  "executionResult": {
    "gasUsed": 23404,
    "excepted": "None",
    "newAddress": "a619b1a87d4f17fb56e347887b971094918b016c",
    "output": "000000000000000000000000000000000000000000000000000000000000015e", # result
    "codeDeposit": 0,
    "gasRefunded": 0,
    "depositSize": 0,
    "gasForDeposit": 0
  },
  "transactionReceipt": {
    "stateRoot": "a040c9b3ba184d57ae0942fb70dfdeba9c436809ec66c855b2d15441c46824d8",
    "gasUsed": 23404,
    "bloom": "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    "log": [
    ]
  }
}

# output: 000000000000000000000000000000000000000000000000000000000000015e
# converted to decimal format = 350
</code></pre>
</li>
</ul>
</li>
</ol>
<h1 id="parse-events-with-ethabi">Parse Events with ethabi</h1>
<ol>
<li><a href="#launch-qtum-daemon">Launch Qtum daemon</a></li>
<li>Open a new Terminal tab</li>
<li>Copy the <a href="../info/#interface-abi">ABI</a> to a file named <code>BodhiToken.json</code> and save it</li>
<li>
<p>How to construct the <code>ethabi decode log</code></p>
<pre><code>ethabi decode log &lt;abi-path&gt; &lt;event-name&gt; [-l &lt;topic&gt;]... &lt;data&gt;
# note that each "topic" needs to be preceeded by "-l"
</code></pre>
</li>
<li>
<p>Parsing event Transfer(address indexed _from, address indexed _to, uint256 _value):</p>
<p>a. Get all Transfer events</p>
<pre><code>$ ./qtum-cli searchlogs 1 -1 '{"addresses": ["6b8bf98ff497c064e8f0bde13e0c4f5ed5bf8ce7"]}' '{"topics": ["ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"]}'
# searchlogs = command to search through transactions on the blockchain
# 1 = starting block number
# -1 = ending block number (-1 goes to the latest block)
# addresses = BOT contract address
# topics = hashes of the events to watch, ie. this is the hash of the Transfer event.

# sample Transfer event fetched from searchlogs call
[
    {
        "blockHash": "c79bcecae6bc7611b56960be0c3c2041f9e3ebfc2e73da0357462078361ba06f",
        "blockNumber": 46831,
        "transactionHash": "32c6874925aa0d400fad4c655283ab6c18d84c003f4e4f8c3cac32675d2eff5b",
        "transactionIndex": 8,
        "from": "d965cdc9eff7412a278cd9dd7dc32e022b7bada4",
        "to": "6b8bf98ff497c064e8f0bde13e0c4f5ed5bf8ce7",
        "cumulativeGasUsed": 21422, 
        "gasUsed": 21422,
        "contractAddress": "6b8bf98ff497c064e8f0bde13e0c4f5ed5bf8ce7",
        "log": [
            {
                "address": "6b8bf98ff497c064e8f0bde13e0c4f5ed5bf8ce7",
                "topics": [
                    "ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef", 
                    "000000000000000000000000d965cdc9eff7412a278cd9dd7dc32e022b7bada4", 
                    "000000000000000000000000c0d3421708f1574e00959c082e75a77ff4770bed"
                ],
                "data": "0000000000000000000000000000000000000000000000000000000005f5e100"
            }
        ]
    }
]
</code></pre>
<p>b. Parse the Transfer event:</p>
<pre><code>$ ethabi decode log ~/Desktop/BodhiToken.json Transfer -l ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef -l 000000000000000000000000d965cdc9eff7412a278cd9dd7dc32e022b7bada4 -l 000000000000000000000000c0d3421708f1574e00959c082e75a77ff4770bed 0000000000000000000000000000000000000000000000000000000005f5e100

_from d965cdc9eff7412a278cd9dd7dc32e022b7bada4
_to c0d3421708f1574e00959c082e75a77ff4770bed
_value 0000000000000000000000000000000000000000000000000000000005f5e100
# the values "_from", "_to", and "_value" are printed out neatly
</code></pre>
</li>
<li>
<p>Parsing event Mint(uint256 supply, address indexed to, uint256 amount):</p>
<p>a. Get all Mint events:</p>
<pre><code>$ ./qtum-cli searchlogs 1 -1 '{"addresses": ["6b8bf98ff497c064e8f0bde13e0c4f5ed5bf8ce7"]}' '{"topics": ["4e3883c75cc9c752bb1db2e406a822e4a75067ae77ad9a0a4d179f2709b9e1f6"]}'

# sample Mint event fetched from searchlogs call
[
    {
        "blockHash": "8d30c1b633b5dd90f159f146e0f919b2b6271afa8c302d06fb4ed04ec733c0b8",
        "blockNumber": 46828,
        "transactionHash": "ba58122f413cb00ca83262f6be87c57b48b08bf100d90ebb5285c84b018f1d2c",
        "transactionIndex": 9,
        "from": "d965cdc9eff7412a278cd9dd7dc32e022b7bada4",
        "to": "6b8bf98ff497c064e8f0bde13e0c4f5ed5bf8ce7",
        "cumulativeGasUsed": 51789,
        "gasUsed": 51789,
        "contractAddress": "6b8bf98ff497c064e8f0bde13e0c4f5ed5bf8ce7",
        "log": [
            {
                "address": "6b8bf98ff497c064e8f0bde13e0c4f5ed5bf8ce7",
                "topics": [
                    "4e3883c75cc9c752bb1db2e406a822e4a75067ae77ad9a0a4d179f2709b9e1f6", 
                    "000000000000000000000000d965cdc9eff7412a278cd9dd7dc32e022b7bada4"
                ],
                "data": "00000000000000000000000000000000000000000000000000038d7ec889c6000000000000000000000000000000000000000000000000000000000005f5e100"
            }
        ]
    }
]
</code></pre>
<p>b. Parse the Mint event:</p>
<pre><code>$ ethabi decode log ~/Desktop/BodhiToken.json Mint -l 4e3883c75cc9c752bb1db2e406a822e4a75067ae77ad9a0a4d179f2709b9e1f6 -l 000000000000000000000000d965cdc9eff7412a278cd9dd7dc32e022b7bada4 00000000000000000000000000000000000000000000000000038d7ec889c6000000000000000000000000000000000000000000000000000000000005f5e100

supply 00000000000000000000000000000000000000000000000000038d7ec889c600
to d965cdc9eff7412a278cd9dd7dc32e022b7bada4
amount 0000000000000000000000000000000000000000000000000000000005f5e100
# this neatly prints out the values for "supply", "to", and "amount"
</code></pre>
</li>
</ol>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../bodhi_core/info/" class="btn btn-neutral float-right" title="Info">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../qt_wallet_desktop/" class="btn btn-neutral" title="QT Wallet (Desktop)"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../qt_wallet_desktop/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../bodhi_core/info/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.10/clipboard.min.js"></script>
      <script src="../../js/clipboard.js"></script>
      <script src="../../search/require.js"></script>
      <script src="../../search/search.js"></script>

</body>
</html>
